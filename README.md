## 🧠 项目简介

本项目旨在根据公司业务需求，训练一个高精度的图像分割模型，用于实现家具中部件级别的自动语义分割。  
当前市面上缺乏专门针对部件级别的分割模型，因此本项目填补了这一空白，  
为后续自动化检测、装配分析和结构识别等场景提供基础支持。

## 🧩 数据集准备

数据集使用 **LabelMe** 工具进行创建，主要用于语义分割任务。  
通过 LabelMe，我们手动标注了相关部件的区域，并生成了 **JSON 格式的标注文件**。  
每个图像都有一个对应的 JSON 文件，其中包含了图像中每个部件的详细标注信息（如多边形边界框、类别标签等）。  
这些标注文件将作为模型训练的输入数据，为分割模型提供语义信息。

## 🛠️ `mask.py` 文件说明

在数据集准备过程中，使用了 **mask.py** 脚本来处理生成模型训练所需的 **mask 文件**。  
该脚本的主要功能是将 **LabelMe** 标注的 JSON 文件转换为适合模型训练的二值掩码（mask）图像。  
每个图像中的部件会被标记为独立的区域，并转化为对应的 **mask 文件**，以便用于训练语义分割模型。  
这些 mask 文件对于训练过程中的像素级别标注至关重要，是模型识别和分割图像部件的基础。

## ⚙️ `train_configs.json` 超参数配置文件

**train_configs.json** 是本项目的超参数配置文件，包含了训练过程中的各种设置。以下是文件的具体内容和说明：
- **use_cross_validation**:  
  是否启用交叉验证（默认为 `true`），本项目使用 5 折交叉验证来评估模型的性能。
- **num_folds**:  
  交叉验证的折数，本项目设置为 5，意味着数据集会被划分为 5 个子集，每个子集作为一次验证集，其他子集作为训练集。
- **configs**:  
  训练配置数组，用户可以定义多个训练配置项。每个配置项包括以下超参数：
  - **name**:  
    训练配置的名称，用于标识不同的训练设置。此处示例为 `"3-31"`。
  - **num_epochs**:  
    训练的轮数，表示模型将对训练数据进行多少次迭代。在该配置中，训练轮数为 10。
  - **batch_size**:  
    每个训练批次的数据量，设置为 4，意味着每次训练将处理 4 张图片。
  - **lr** (learning rate):  
    学习率，控制模型权重更新的幅度。此配置的学习率为 `0.0003`。
  - **weight_decay**:  
    权重衰减（L2 正则化）系数，用于防止过拟合。在此配置中设置为 `0.01`。
  - **patience**:  
    提前停止的容忍轮数，防止训练过拟合。当验证集的性能在连续 10 轮内没有提升时，将提前停止训练。
  - **use_importance_factors**:  
    是否使用重要性因子，这个参数决定了是否根据样本的不同重要性调整损失函数。在该配置中，设置为 `false`。

## 🏋️‍♂️ `V3.py` 训练模型文件

**V3.py** 是本项目的模型训练脚本，负责加载数据集、配置训练参数、初始化模型并执行训练过程。  
在该脚本中，模型的结构、损失函数、优化器等都进行了配置，并且通过读取 **train_configs.json** 配置文件来动态加载超参数。  
执行 `V3.py` 脚本后，模型将开始训练并输出训练日志，最终生成训练好的模型文件。

## 🎯 训练结果

经过模型训练与评估，本项目的图像分割模型在验证集上的 **准确率高达 94%**。  
该结果展示了模型在部件级别分割任务中的优秀表现，能够准确地分割出图像中的不同部件。

## 🖼️ 预测图片展示

以下是模型在实际图像上的预测效果展示：

- **预测结果**：
  ![预测结果](pre.png)

这些结果证明了模型在实际应用中的有效性，并为后续业务提供了可靠的支持。

工程结构说明
```
DeepLabV3/  
├── images/                # 原始图像数据  
├── json/                  # LabelMe 导出的 JSON 标注文件  
├── masks/                 # 生成的 mask 掩码图像  
├── templates/               
├── inference.py           # 模型推理脚本  
├── mask.py                # JSON 转 mask 的数据处理脚本  
├── train_configs.json     # 训练配置文件（包含超参数设定）  
├── V3.py                  # 模型训练主脚本  
```
